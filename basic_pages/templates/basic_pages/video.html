{% extends 'users/base.html' %}
{% load static %}

{% block title %}{{ video.title }}{% endblock %}

{% block styles %}
    <link rel="stylesheet" type="text/css" href="{% static 'basic_pages/css/video_watch.css' %}" />
{% endblock %}

{% block content %}
    <div id="content_sec">
        <div class="video-container">
            <div class="video-player">
              <video src="{{ video.video }}" controls></video>
            </div>
            <div class="video-details">
                <div style="display: none">
                    <span id="id_video">{{ video.id_video }}</span>
                </div>
                <div class="info">
                    <a href="{{ author.url }}">
                     <div class="author-info">
                      <div class="avatar">
                          <img src="{{ author.avatar }}" alt="–ê–≤–∞—Ç–∞—Ä">
                      </div>
                      <div class="author-name">
                        <h4>{{ author.name }}</h4>
                      </div>
                     </div>
                    </a>
                  <div class="rating-buttons">
                    <span class="views">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {{ video.views_count }}</span>
                        <button id="like-button" class="{% if like %}liked{% endif %}">
                          <span class="icon">üëç</span>
                          <span id="like-count" class="count">{{ video.likes_count }}</span>
                        </button>
                        <button id="dislike-button" class="{% if dislike %}liked{% endif %}">
                          <span class="icon">üëé</span>
                          <span id="dislike-count" class="count">{{ video.dislikes_count }}</span>
                        </button>
                  </div>
                </div>
              <h1>{{ video.title }}</h1>
              <p class="video-description">{{ video.description }}</p>



              <div class="comment-section">
                  <h2>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</h2>
                    {% if user.is_authenticated %}
                        <div class="comment-form">
                          <h3>–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>
                          <form method="POST" action="{% url 'add-comment' video.id_video %}">
                            {% csrf_token %}
                            <div>
                              <label for="id_text">–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                              <textarea id="id_text" name="text" maxlength="1000" required></textarea>
                            </div>
                            <button type="submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                          </form>
                        </div>
                    {% else %}
                    <p>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a href="{% url 'login' %}">–≤–æ–π—Ç–∏</a>.</p>
                    {% endif %}

                  <ul class="comment-list">
                    {% for c in comments %}
                        <li id="comment-{{c.comment.comment_id}}">
                          <div class="comment-meta">
                            <span class="author"><a href="{{ c.author.url }}">{{ c.author.name }}</a></span>
                            <span class="date">{{ c.comment.date}}</span>
                          </div>
                          <div class="comment-content">{{ c.comment.text }}</div>
                            {% if user.is_authenticated %}
                                {% if c.author.username == user.username %}
                                    <button class="btn-delete-comment" data-comment-id="{{ c.comment.comment_id }}">–£–¥–∞–ª–∏—Ç—å</button>
                                {% endif %}
                            {% endif %}
                        </li>
                    {% empty %}
                      <p>–ö —ç—Ç–æ–º—É –≤–∏–¥–µ–æ –µ—â–µ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.</p>
                    {% endfor %}
                  </ul>
              </div>
            </div>
        </div>
  </div>

  <script src="{% static 'basic_pages/js/like_dislike.js' %}"></script>
  <script src="{% static 'basic_pages/js/comments.js' %}"></script>
{% endblock %}